openapi: 3.0.2
info:
  version: 4.5.0
  title: DX Data Marketplace APIs
  description: 'The data marketplace is Data Exchange (DX) platform that enables data Providers to host their datasets as a product. Likewise, data consumers can buy the products listed by various providers '
  contact:
    email: support@iudx.org.in
    name: For support contact IUDX team at
paths:
  /provider/product:
    post:
      tags:
        - provider
      summary: ''
      description: |-
        Create a product where the body contains the name and the array of resources that will be part of the product. 
        The name cannot be updated once the product is created as it is a unique identifier for a product of a provider. The name is stored as a URN(for eg: a product named flood-sensors hosted by the provider with id 4efde16f-96cd-4b86-b6ee-ca5102413ff6 is represented as urn:datakaveri.org:4efde16f-96cd-4b86-b6ee-ca5102413ff6:flood-sensors)
      operationId: Create Product
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/exampleProductPostBody'
            examples:
              Create product body:
                value:
                  name: flood-sensors
                  resources:
                    - e3e940d9-5743-4229-bd9b-d7c2c80264bf
                    - 9c2df357-4d3b-46fd-9d24-3248867eb77e
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/successResponseWithObjects'
              examples:
                Create product success:
                  value:
                    type: 'urn:dx:dmp:Sucess'
                    title: Success
                    results:
                      - productID: 'urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb'
        '400':
          description: invalid document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Already exists:
                  value:
                    type: 'urn:dx:dmp:AlreadyExists'
                    results:
                      - productID: 'urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb'
                        method: insert
                        title: failed
                        detail: 'Fail: Doc exists'
                    title: Product already exists
                Invalid productID:
                  value:
                    type: 'urn:dx:dmp:InvalidProductIDValue'
                    title: Bad request
                    detail: 'Invalid ProductID [ abc&23? ]'
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
    delete:
      tags:
        - provider
      summary: ''
      operationId: Delete Product
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
        - name: productID
          in: query
          description: urn name of the product
          required: true
          schema:
            type: string
            pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
            minLength: 36
            maxLength: 36
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/successResponseForDeleteProduct'
        '400':
          description: invalid document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Doesn't Exist:
                  value:
                    type: 'urn:dx:dmp:DocDoesNotExist'
                    results:
                      productID: 'urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb'
                      method: delete
                      title: failed
                      detail: 'Fail: Cannot delete, Doc does not exist'
                    title: Product does not exist
                Invalid productID:
                  value:
                    type: 'urn:dx:dmp:InvalidProductIDValue'
                    title: Bad request
                    detail: 'Invalid productID [ abc&23? ]'
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /provider/list/products:
    get:
      tags:
        - provider
      operationId: List Products
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
        - name: resourceID
          in: query
          description: 'If resourceID is provided for listing, then products are filtered to show products only for that resource'
          required: false
          schema:
            type: string
            pattern: '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'
            minLength: 36
            maxLength: 36
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        productid:
                          type: string
                        providername:
                          type: string
                        resources:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: string
                              name:
                                type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: 2d043bdb-fc62-4650-8426-dc72492cd621
                            name: TEST ITEM FOR APD /verify TESTS
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct5ui'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: b58da193-23d9-43eb-b98a-a103d4b6103c
                            name: FW055 Environment-UUID
              examples:
                List All Products:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: 2d043bdb-fc62-4650-8426-dc72492cd621
                            name: TEST ITEM FOR APD /verify TESTS
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct5ui'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: b58da193-23d9-43eb-b98a-a103d4b6103c
                            name: FW055 Environment-UUID
                List Products for Resource:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
        '204':
          description: no content
        '400':
          description: invalid document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Invalid ID:
                  value:
                    type: 'urn:dx:dmp:InvalidResourceIDValue'
                    title: Bad request
                    detail: Invalid resource ID
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /provider/list/purchases:
    get:
      tags:
        - provider
      operationId: List Purchases
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
        - name: productID
          in: query
          description: urn name of the product
          required: false
          schema:
            type: string
            pattern: '^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'
            minLength: 36
            maxLength: 36
        - name: resourceID
          in: query
          description: 'If resourceID is provided for listing, then purchases are filtered to show purchases against that resource'
          required: false
          schema:
            type: string
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/exampleResponseListPurchases'
        '204':
          description: no content
        '400':
          description: invalid document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Doesn't Exist:
                  value:
                    type: 'urn:dx:dmp:DocDoesNotExist'
                    results:
                      - productID: 'urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb'
                        method: list
                        title: failed
                        detail: 'Fail: Doc does not exist'
                    title: Product does not exist
                Invalid name:
                  value:
                    type: 'urn:dx:dmp:InvalidNameValue'
                    title: Bad request
                    detail: 'Invalid name [ abc&23? ]'
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /provider/product-variant:
    post:
      tags:
        - provider
      summary: ''
      description: 'Create a product variant where the body contains details about the variant such as price, duration, resources and their capabilities. Along with the name of the variant and the product it belongs to.'
      operationId: Create Product Variant
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                variant:
                  type: string
                resources:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                      capabilities:
                        type: array
                        items:
                          type: string
                    required:
                      - id
                      - capabilities
                price:
                  type: integer
                validity:
                  type: integer
              required:
                - id
                - variant
                - resources
                - price
                - validity
              x-examples:
                Example 1:
                  id: 'urn:datakaveri.org:iisc.ac.in/123qwerty:flood-sensors'
                  variant: sensors-1
                  resources:
                    - id: pune-flood
                      capabilities:
                        - api
                        - sub
                    - id: stqc-flood
                      capabilities:
                        - sub
                        - file
                  price: 100
                  validity: 12
            examples:
              Example 1:
                value:
                  id: 'urn:datakaveri.org:iisc.ac.in/123qwerty:flood-sensors'
                  variant: sensors-1
                  resources:
                    - id: pune-flood
                      capabilities:
                        - api
                        - sub
                    - id: stqc-flood
                      capabilities:
                        - sub
                        - file
                  price: 100
                  validity: 12
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/successResponseWithObjects'
              examples:
                Example 1:
                  value:
                    type: 'urn:dx:dmp:Success'
                    title: Success
                    results: []
    get:
      tags:
        - provider
      summary: ''
      operationId: Get Product Variant
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          schema:
            type: string
        - name: id
          in: query
          schema:
            type: string
        - name: variant
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
    put:
      tags:
        - provider
      summary: ''
      operationId: Update Product Variant
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                variant:
                  type: string
                resources:
                  type: array
                  items:
                    type: object
                    properties:
                      id:
                        type: string
                      capabilities:
                        type: array
                        items:
                          type: string
                    required:
                      - id
                      - capabilities
                price:
                  type: integer
                validity:
                  type: integer
              required:
                - id
                - variant
                - resources
                - price
                - validity
              x-examples:
                Example 1:
                  id: 'urn:datakaveri.org:iisc.ac.in/123qwerty:flood-sensors'
                  variant: sensors-1
                  resources:
                    - id: pune-flood
                      capabilities:
                        - api
                        - sub
                    - id: stqc-flood
                      capabilities:
                        - sub
                        - file
                  price: 100
                  validity: 12
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/successResponseWithObjects'
    delete:
      tags:
        - provider
      summary: ''
      operationId: Delete Product Variant
      parameters:
        - name: token
          in: header
          description: IUDX Auth token to process the request
          schema:
            type: string
        - name: id
          in: query
          schema:
            type: string
        - name: variant
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/successResponseForDeleteProduct'


  /account:
    post:
      tags:
        - provider
      summary: Create Linked account
      description: |-
        A provider could create a linked account to start the process of receiving payments via Payment Gateway. A provider or provider 
        delegate could use this API to provide their business related information. Once a linked account is created, the provider can
        visit their payment gateway related dashboard to switch their merchant account, monitor payment done to their account 
        and refund amount if a customer raises a dispute. A provider could update their account related information like account number, IFSC code through
        their dashboard.
        <br>
        <br>
      operationId: post-linked-account-v1
      parameters:
        - name: token
          in: header
          description: AAA issued identity token
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 512
            pattern: '^[a-zA-Z0-9_*\-*\.\/]+$'
      requestBody:
        description: Request body is a JsonObject containing ID whose value is the policy ID.
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  pattern: '^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$'
                  minLength: 1
                  description: A valid business email account
                phone:
                  type: string
                  minLength: 8
                  maxLength: 15
                  description: Business phone number
                legalBusinessName:
                  type: string
                  minLength: 4
                  maxLength: 200
                  description: Linked Account's business
                customerFacingBusinessName:
                  type: string
                  minLength: 1
                  maxLength: 255
                  description: Linked account billing label
                businessType:
                  type: string
                  enum: [llp, ngo, other, individual, partnership, proprietorship, public_limited, private_limited, trust, society, not_yet_registered, educational_institutes]
                  description: Provider's business type. Here are the list of values - [link](https://razorpay.com/docs/payments/route/integration-guide/#business-type)
                contactName:
                  type: string
                  description: name of the contact
                  minLength: 4
                  maxLength: 255
                profile:
                  description: Business profile for linked account
                  type: object
                  properties:
                    category:
                      type: string
                      enum: [financial_services, education, healthcare, utilities, government, logistics, tours_and_travel ,transport ,ecommerce ,food ,it_and_software ,gaming ,media_and_entertainment ,services ,housing ,not_for_profit ,social ,others]
                      description: business category of the account holder. Please refer the given link to look at updated list of suitable values for category field - [link](https://razorpay.com/docs/payments/route/integration-guide/#business-category)
                      minLength: 1
                      required: true
                    subcategory:
                      type: string
                      description: |-
                        business sub-category of the account holder
                        Please refer the given link to find suitable list of values - [link](https://razorpay.com/docs/payments/route/integration-guide/#business-sub-category)
                    addresses:
                      type: object
                      properties:
                        registered:
                          type: object
                          description: Details of account holder's registered address
                          properties:
                            street1:
                              type: string
                              maxLength: 100
                              description: Address Line 1
                            street2:
                              type: string
                              maxLength: 100
                              description: Address Line 2
                            city:
                              type: string
                              maxLength: 100
                              description: city name
                            state:
                              type: string
                              minLength: 2
                              maxLength: 32
                              description: state name
                            postalCode:
                              type: string
                              minLength: 6
                              maxLength: 6
                            country:
                              type: string
                              minLength: 2
                              maxLength: 64
                              description: |-
                                country code in capital letters `IN` or full name of the country in lower case letters `india`
                                <br>
                                Here is a list of support countries - [link](https://razorpay.com/docs/partners/aggregators/onboarding-api/appendix/#country-list)

                          required:
                            - street1
                            - street2
                            - city
                            - state
                            - postalCode
                            - country
                      required:
                        - registered
                  required:
                    - category
                    - subcategory
                    - addresses
                legalInfo:
                  type: object
                  description:
                  properties:
                    pan:
                      type: string
                      minLength: 10
                      maxLength: 10
                      pattern: '/^[a-zA-z]{5}\d{4}[a-zA-Z]{1}$/'
                    gst:
                      type: string
                      minLength: 15
                      maxLength: 15
                      pattern: '/^[0123][0-9][a-z]{5}[0-9]{4}[a-z][0-9][a-z0-9][a-z0-9]$/gi'
              required:
                - email
                - phone
                - legalBusinessName
                - businessType
                - profile

            examples:
              Request body for Create Linked Account:
                value:
                  email: test.provider@gmail.com
                  phone: 9000090000
                  legalBusinessName: Dummy Corp V1
                  customerFacingBusinessName: Dummy Service Corp V1
                  businessType: partnership
                  contactName: Bob Davis
                  profile:
                    category: healthcare
                    subcategory: clinic
                    addresses:
                      street1: 507, Koramangala 1st block
                      street2: MG Road
                      city: Bengaluru
                      state: KARNATAKA
                      postalCode: 560034
                      country: IN
                  legalInfo:
                    pan: AAACL1234C
                    gst: 18AABCU9603R1ZM

      responses:
        '200':
          description: Linked account creation successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/createLinkedAccount'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '400':
          description: |-
            Bad Request
            - Provider's email was used to create a linked account through DMP Server previously
            - Route code support feature could be enabled by the provider
            - Invalid IFSC code
            - account_code feature not enabled
            - Invalid name, email
            - Enter a valid name with alphanumerics and spaces
            - Account might be suspended

          content:
            application/json:
              schema:
                $ref: '#/components/schemas/createLinkedAccountErrorResponse'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '401':
          description: |-
            Unauthorized
              - `token` invalid/expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unauthorized'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
      security:
        - authorization: [ ]
    put:
      tags:
        - provider
      summary: Update Linked account
      description: |-
        A provider could update details related to their linked account. After creating a linked account through DMP, 
        all the details except `businessType`, `email` could be changed. The accountId could be sent in the request body
        to update the linked account related information. The accountId could be fetched from GET `/account` API
        <br>
        <br>
      operationId: update-linked-account-v1
      parameters:
        - name: token
          in: header
          description: AAA issued identity token
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 512
            pattern: '^[a-zA-Z0-9_*\-*\.\/]+$'
      requestBody:
        description: Request body is a JsonObject containing ID whose value is the policy ID.
        content:
          application/json:
            schema:
              type: object
              properties:
                accountId:
                  type: string
                  minLength: 18
                  maxLength: 18
                  description: ID generated after creating a linked account
                phone:
                  type: string
                  minLength: 8
                  maxLength: 15
                  description: Business phone number
                legalBusinessName:
                  type: string
                  minLength: 4
                  maxLength: 200
                  description: Linked Account's business
                customerFacingBusinessName:
                  type: string
                  minLength: 1
                  maxLength: 255
                  description: Linked account billing label
                contactName:
                  type: string
                  description: name of the contact
                  minLength: 4
                  maxLength: 255
                profile:
                  description: Business profile for linked account
                  type: object
                  properties:
                    category:
                      type: string
                      enum: [ financial_services, education, healthcare, utilities, government, logistics, tours_and_travel ,transport ,ecommerce ,food ,it_and_software ,gaming ,media_and_entertainment ,services ,housing ,not_for_profit ,social ,others ]
                      description: business category of the account holder. Please refer the given link to look at updated list of suitable values for category field - [link](https://razorpay.com/docs/payments/route/integration-guide/#business-category)
                      minLength: 1
                      required: true
                    subcategory:
                      type: string
                      description: |-
                        business sub-category of the account holder
                        Please refer the given link to find suitable list of values - [link](https://razorpay.com/docs/payments/route/integration-guide/#business-sub-category)
                    addresses:
                      type: object
                      properties:
                        registered:
                          type: object
                          description: Details of account holder's registered address
                          properties:
                            street1:
                              type: string
                              maxLength: 100
                              description: Address Line 1
                            street2:
                              type: string
                              maxLength: 100
                              description: Address Line 2
                            city:
                              type: string
                              maxLength: 100
                              description: city name
                            state:
                              type: string
                              minLength: 2
                              maxLength: 32
                              description: state name
                            postalCode:
                              type: string
                              minLength: 6
                              maxLength: 6
                            country:
                              type: string
                              minLength: 2
                              maxLength: 64
                              description: |-
                                country code in capital letters `IN` or full name of the country in lower case letters `india`
                                <br>
                                Here is a list of support countries - [link](https://razorpay.com/docs/partners/aggregators/onboarding-api/appendix/#country-list)

                          required:
                            - street1
                            - street2
                            - city
                            - state
                            - postalCode
                            - country
                      required:
                        - registered
                  required:
                    - category
                    - subcategory
                    - addresses
                legalInfo:
                  type: object
                  description:
                  properties:
                    pan:
                      type: string
                      minLength: 10
                      maxLength: 10
                      pattern: '/^[a-zA-z]{5}\d{4}[a-zA-Z]{1}$/'
                    gst:
                      type: string
                      minLength: 15
                      maxLength: 15
                      pattern: '/^[0123][0-9][a-z]{5}[0-9]{4}[a-z][0-9][a-z0-9][a-z0-9]$/gi'
              required:
                - accountId
                - phone
                - legalBusinessName
                - profile

            examples:
              Request body for Update Linked Account:
                value:
                  accountId: acc_GRWKk7qQsLnDjX
                  phone: 9100090000
                  legalBusinessName: Dummy Corp V2
                  customerFacingBusinessName: Some Other Corp
                  contactName: Test Name
                  profile:
                    category: healthcare
                    subcategory: doctors
                    addresses:
                      street1: Outer Ring road
                      street2: MG Road
                      city: Bengaluru
                      state: KARNATAKA
                      postalCode: 560038
                      country: india
                  legalInfo:
                    pan: ABACL1234C
                    gst: 19AABCU9603R1ZM

      responses:
        '200':
          description: Linked account creation successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/updateLinkedAccount'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '400':
          description: |-
            Bad Request
            - Merchant account has been locked by the admin when extra fields are submitted and are under review
            - Invalid name, email
            - Enter a valid name with alphanumerics and spaces

          content:
            application/json:
              schema:
                $ref: '#/components/schemas/updateLinkedAccountErrorResponse'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '401':
          description: |-
            Unauthorized
              - `token` invalid/expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unauthorized'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '404':
          description: |-
            Not Found
              - A linked account for the given provider was not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/updateLinkedAccountNotFoundResponse'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
      security:
        - authorization: [ ]
    get:
      tags:
        - provider
      summary: Fetch Linked account
      description: |-
        A provider could fetch the information related to their linked account provided while creating the 
        linked account to the Payment Gateway through this endpoint. 
        <br>
        `Note`: This API is only called after calling POST `/account` API through DMP
        <br>
      operationId: get-linked-account-v1
      parameters:
        - name: token
          in: header
          description: AAA issued identity token
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 512
            pattern: '^[a-zA-Z0-9_*\-*\.\/]+$'
      responses:
        '200':
          description: Linked account creation successful
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/fetchLinkedAccountWithGivenFields'
                  - $ref: '#/components/schemas/fetchLinkedAccountWithOtherFields'

          headers:
            Content-Type:
              schema:
                type: string
              description: application/json

        '401':
          description: |-
            Unauthorized
              - `token` invalid/expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unauthorized'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '404':
          description: |-
            Not Found
              - Linked account for the given provider is not found if it we try fetching it before a linked account is successfully created
                or if linked account is yet to be to be approved by Payment Gateway
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/fetchLinkedAccountNotFound'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
      security:
        - authorization: [ ]

  /consumer/list/resources:
    get:
      tags:
        - consumer
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
        - name: providerID
          in: query
          description: Id of the provider for listing their resources
          required: false
          schema:
            type: string
        - name: resourceID
          in: query
          description: Id of the resource for its details
          required: false
          schema:
            type: string
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        resource_name:
                          type: string
                        accesspolicy:
                          type: string
                        providername:
                          type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - _id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                        resource_name: Chandigarh Paid Parking Locations
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
                      - _id: 2d043bdb-fc62-4650-8426-dc72492cd621
                        resource_name: TEST ITEM FOR APD /verify TESTS
                        accesspolicy: SECURE
                        providername: Administrator of the IUDX platform
                      - _id: b58da193-23d9-43eb-b98a-a103d4b6103c
                        resource_name: FW055 Environment-UUID
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
                      - _id: ae2b8b01-f642-411a-babb-cbd1b75fa2a1
                        resource_name: Flood level data from FWR055
                        accesspolicy: SECURE
                        providername: Administrator of the IUDX platform
              examples:
                List All Resources:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - _id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                        resource_name: Chandigarh Paid Parking Locations
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
                      - _id: 2d043bdb-fc62-4650-8426-dc72492cd621
                        resource_name: TEST ITEM FOR APD /verify TESTS
                        accesspolicy: SECURE
                        providername: Administrator of the IUDX platform
                      - _id: b58da193-23d9-43eb-b98a-a103d4b6103c
                        resource_name: FW055 Environment-UUID
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
                      - _id: ae2b8b01-f642-411a-babb-cbd1b75fa2a1
                        resource_name: Flood level data from FWR055
                        accesspolicy: SECURE
                        providername: Administrator of the IUDX platform
                List Resource of Provider:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - _id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                        resource_name: Chandigarh Paid Parking Locations
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
                      - _id: 2d043bdb-fc62-4650-8426-dc72492cd621
                        resource_name: TEST ITEM FOR APD /verify TESTS
                        accesspolicy: SECURE
                        providername: Administrator of the IUDX platform
                      - _id: b58da193-23d9-43eb-b98a-a103d4b6103c
                        resource_name: FW055 Environment-UUID
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
                      - _id: ae2b8b01-f642-411a-babb-cbd1b75fa2a1
                        resource_name: Flood level data from FWR055
                        accesspolicy: SECURE
                        providername: Administrator of the IUDX platform
                List Resource by ID:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - _id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                        resource_name: Chandigarh Paid Parking Locations
                        accesspolicy: OPEN
                        providername: Administrator of the IUDX platform
        '204':
          description: no content
        '400':
          description: invalid document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Doesn't Exist:
                  value:
                    type: 'urn:dx:dmp:DocDoesNotExist'
                    detail: 'Fail: provider does not exist'
                    title: Provider does not exist
                Invalid name:
                  value:
                    type: 'urn:dx:dmp:InvalidNameValue'
                    title: Bad request
                    detail: 'Invalid provider id value [ abc&23? ]'
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /consumer/list/providers:
    get:
      tags:
        - consumer
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
        - name: providerID
          in: query
          description: Id of the provider for its details
          required: false
          schema:
            type: string
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        provider_id:
                          type: string
                        providername:
                          type: string
                        resource_server:
                          type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - provider_id: b2c27f3f-2524-4a84-816e-91f9ab23f837
                        providername: Administrator of the IUDX platform
                        resource_server: 49cf5c76-09de-11ee-be56-0242ac120002
              examples:
                List All Providers:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - provider_id: b2c27f3f-2524-4a84-816e-91f9ab23f837
                        providername: Administrator of the IUDX platform
                        resource_server: 49cf5c76-09de-11ee-be56-0242ac120002
                      - provider_id: c3a2af3f-2524-4a84-816e-91f9ab23d375
                        providername: Administrator of platform
                        resource_server: 49cf5c76-09de-11ee-be56-0242ac120002
                List Provider by ID:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - provider_id: b2c27f3f-2524-4a84-816e-91f9ab23f837
                        providername: Administrator of the IUDX platform
                        resource_server: 49cf5c76-09de-11ee-be56-0242ac120002
        '204':
          description: no content
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /consumer/list/purchases:
    get:
      tags:
        - consumer
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/exampleResponseListPurchases'
        '204':
          description: no content
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /consumer/list/products:
    get:
      tags:
        - consumer
      parameters:
        - name: token
          in: header
          description: DX Auth token to process the request
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9\/\@\.]*$'
            maxLength: 512
        - name: resourceID
          in: query
          description: ID of the resource for listing products that contain it.
          required: false
          schema:
            type: string
        - name: providerID
          in: query
          description: Id of the provider for listing their products
          required: false
          schema:
            type: string
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                  title:
                    type: string
                  results:
                    type: array
                    items:
                      type: object
                      properties:
                        productid:
                          type: string
                        providername:
                          type: string
                        resources:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: string
                              name:
                                type: string
                x-examples:
                  Example 1:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: 2d043bdb-fc62-4650-8426-dc72492cd621
                            name: TEST ITEM FOR APD /verify TESTS
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct5ui'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: b58da193-23d9-43eb-b98a-a103d4b6103c
                            name: FW055 Environment-UUID
              examples:
                List All Products:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: 2d043bdb-fc62-4650-8426-dc72492cd621
                            name: TEST ITEM FOR APD /verify TESTS
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct5ui'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: b58da193-23d9-43eb-b98a-a103d4b6103c
                            name: FW055 Environment-UUID
                List Products with Resource ID:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
                List Products with Provider ID:
                  value:
                    type: 'urn:dx:dmp:success'
                    title: Success
                    results:
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct1'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: 2d043bdb-fc62-4650-8426-dc72492cd621
                            name: TEST ITEM FOR APD /verify TESTS
                          - id: a347c5b6-5281-4749-9eab-89784d8f8f9a
                            name: Chandigarh Paid Parking Locations
                      - productid: 'urn:datakaveri.org:b2c27f3f-2524-4a84-816e-91f9ab23f837:testProduct5ui'
                        providername: Administrator of the IUDX platform
                        resources:
                          - id: b58da193-23d9-43eb-b98a-a103d4b6103c
                            name: FW055 Environment-UUID
        '204':
          description: no content
        '400':
          description: invalid document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Invalid ID:
                  value:
                    type: 'urn:dx:dmp:InvalidResourceIDValue'
                    title: Bad request
                    detail: Invalid resource ID
        '401':
          description: Unauthorized access
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/errorResponseWithObjects'
              examples:
                Unauthorized:
                  value:
                    type: 'urn:dx:cat:InvalidAuthorizationToken'
                    title: Token is invalid
                    detail: failed
  /consumer/create-purchase:
    post:
      tags:
        - consumer
      operationId: post-consumer-create-purchase
      parameters:
        - name: token
          in: header
          description: DX Auth consumer token to process the request
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                variantId:
                  type: string
                  description: Product Variant ID
                stateId:
                  type: string
                  description: |
                    Generated at UI to maintain state of a purchase
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  purchaseID:
                    type: string
                  variantID:
                    type: string
                  purchasedAt:
                    type: string
                  status:
                    type: string
  /verify:
    post:
      tags:
        - Policies
      summary: Verify Policy
      description: |
        Verify API endpoint is used by DX AAA Server to check if a policy is present for a given consumer for the given 
        resource with a specified provider of the resource. This check is done by DX AAA Server before issuing 
        a token. 

        DMP Data Marketplace APD Server creates policy for a given item with type `resource`
      operationId: post-verify-policy
      parameters:
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
            description: Keycloak issued token
            minLength: 1
            maxLength: 512
            example: Bearer <JWT>
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/exampleVerifyRequestBody'
            examples:
              Request body for verify policy:
                value:
                  user:
                    id: a109807f-6b06-4d8a-ab64-a3a19b04a3b4
                    name:
                      firstName: test
                      lastName: consumer
                    email: consumer@gmail.com
                  owner:
                    id: 114077a3-6411-4b6e-bc97-c7e81b87685d
                    name:
                      firstName: test
                      lastName: provider
                    email: test@provider.com
                  item:
                    itemId: 2a0be315-4165-4c5b-a74e-116cc89272cb
                    itemType: resource
      responses:
        '200':
          description: |-
            OK
            - An active policy is present for the consumer for given resource with given constraints
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/verifyPolicySuccessResponse'
        '400':
          description: |-
            Bad request
            - Invalid request schema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/verifyPolicyBadRequestResponse'
        '403':
          description: |-
            forbidden
            - Policy does not exist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/verifyPolicyForbiddenResponse'
      security:
        - authorization: []
      x-internal: false
  /policy:
    get:
      tags:
        - Policies
      summary: Get Policies
      description: |
        Get policies associated with a specific user. The response is determined by the user's roles:

        - If the user is a `provider`, the response includes all policies created by the provider or their delegates.
        - If the user is a `delegate`, the response comprises policies set by the delegate or set for the consumer on whose behalf the delegate is acting.
        - If the user is a `consumer`, the response includes policies set for the consumer.

        `Note`: Please note that the response displays the policies for a user concerning a specific server.
      operationId: get-auth-v1-policies
      parameters:
        - name: Authorization
          in: header
          description: AAA issued identity token
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9_*\-*\.\/]+$'
            minLength: 1
            maxLength: 512
      responses:
        '200':
          description: Policies have been successfully listed.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getPolicySuccessResponseWithResourceType'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '401':
          description: |-
            Unauthorized
              - `token` invalid/expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unauthorized'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '404':
          description: Not Found - Policy not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/policyNotFound'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
      security:
        - authorization: []
    delete:
      tags:
        - Policies
      summary: Delete Policy
      description: |-
        A provider of the resource can delete the policy. An existing active policy can be deleted by the provider or provider delegate. The request would contain id, i.e. the ID of the policy that the user wants to delete. The user can use the GET Policy API to get the policy ID.
        <br>
        <br>
        `Note`: A Provider gets to delete the policy if they find any conflict of interest with a given consumer accessing their resource
      operationId: delete-auth-v1-policies
      parameters:
        - name: Authorization
          in: header
          description: AAA issued identity token
          required: true
          schema:
            type: string
            pattern: '^[a-zA-Z0-9_*\-*\.\/]+$'
            minLength: 1
            maxLength: 512
      requestBody:
        description: Request body is a JsonObject containing ID whose value is the policy ID.
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  pattern: '^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$'
                  minLength: 36
                  maxLength: 36
              required:
                - id
            examples:
              Request body for Delete Policy:
                value:
                  id: 231f6eca-6276-4993-bfeb-53cbbbba6f06
      responses:
        '200':
          description: User Policy deleted successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/deletePolicy'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '400':
          description: |-
            Bad Request
            - Id is not a valid policyId
            - Policy has expired
            - Policy was previously deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/deletePolicyErrorResponse'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '401':
          description: |-
            Unauthorized
              - `token` invalid/expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unauthorized'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '404':
          description: |-
            Not Found
              - Policy id does not exist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/deletePolicyNotFoundErrorResponse'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
      security:
        - authorization: []
    post:
      tags:
        - Policies
      summary: Create Policy
      description: |-
        This API is called when a consumer successful purchase against a product variant. 
        A policy is created for each resource in the product variant for the consumer on behalf of the provider and 
        provider cannot directly create a policy for a consumer. 
        
        <br>
      operationId: post-auth-v1-policies
      parameters:
        - name: token
          in: header
          description: AAA issued identity token
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 512
            pattern: '^[a-zA-Z0-9_*\-*\.\/]+$'
      requestBody:
        description: Request body contains payment related information and product related information
        content:
          application/json:
            schema:
              type: object
              properties:
                orderId:
                  type: string
                  minLength: 1
                  description: orderId generated before a payment
                paymentId:
                  type: string
                  minLength: 1
                  description: paymentId generated after a successful payment
                paymentSignature:
                  type: string
                  minLength: 1
                  description: payment signature generated after a successful payment
                productVariantId:
                  type: string
                  format: uuid
                  pattern: '^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$'
                  minLength: 36
                  maxLength: 36

              required:
                - orderId
                - paymentId
                - paymentSignature
                - productVariantId
            examples:
              Request body for Create Policy:
                value:
                  orderId: order_NSajISG3GuJZpO
                  paymentId: pay_NSmdXTf3ivKwBv
                  paymentSignature: 0d4e745a1838664ad6c9c9902212a32d627d68e917290b0ad5f08ff4561bc50f
                  productVariantId: 05f1765f-0fc9-41c2-dmfc-1dec2c168919

      responses:
        '200':
          description: User Policy created successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/createPolicy'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
        '400':
          description: |-
            Bad Request
            - Missing or invalid fields

          content:
            application/json:
              schema:
                $ref: '#/components/schemas/createPolicyErrorResponse'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json

        '401':
          description: |-
            Unauthorized
              - `token` invalid/expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Unauthorized'
          headers:
            Content-Type:
              schema:
                type: string
              description: application/json
      security:
        - authorization: [ ]

tags:
  - name: provider
    description: |
      Datamarketplace specific data provider APIs.
    x-displayName: Provider
  - name: consumer
    description: |
      Catalogue consumer specific apis.
    x-displayName: Consumer
components:
  securitySchemes:
    authorization:
      type: http
      scheme: bearer
  schemas:
    exampleProductPostBody:
      type: object
      title: Root type for product body
      description: example request for creating product
      properties:
        name:
          type: string
        resources:
          type: array
          items:
            type: object
            properties:
              resourceID:
                type: string
                format: uuid
      example:
        name: flood-sensors
        description: some description for flod-sensors
        price: 50
        duration: 12
        resources:
          - e3e940d9-5743-4229-bd9b-d7c2c80264bf
          - 9c2df357-4d3b-46fd-9d24-3248867eb77e
    successResponseWithObjects:
      type: object
      title: Root Type for standardResponse
      description: example Response for get products request
      properties:
        totalHits:
          type: integer
          description: Total number of documents which matched the query.
          format: int32
        results:
          type: array
          description: Results which matched the query. This is an array of objects.
          items:
            type: object
        detail:
          type: string
          description: Detailed description of the type or response
        type:
          type: string
          description: URN type of the response indicating if the query was successful or if any errors have been triggered.
        title:
          description: A human readable title to the message response.
      required:
        - type
      example:
        type: 'urn:dx:dmp:Success'
        title: Success
        totalHits: 1
        results:
          - productID: 'the productID formatted as a URN - URN would be based on the APD URL (e.g. urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb)'
            description: some text description for the product (e.g. a student associated in DataKaveri)
            price: 100
            duration: 12
            resources:
              - pune-env-flood
              - stqc-flood-sensor
    errorResponseWithObjects:
      type: object
      title: Root Type for standardResponse
      description: example Response for get products request
      properties:
        detail:
          type: string
          description: Detailed description of the type or response
        type:
          type: string
          description: URN type of the response indicating if the query was successful or if any errors have been triggered.
        title:
          description: A human readable title to the message response.
      required:
        - type
    successResponseForDeleteProduct:
      type: object
      title: Root Tupe for standard DELETE response
      description: example response for delete product API
      properties:
        type:
          type: string
          description: URN type of the response indicating if the query was successful or if any errors have been triggered.
        title:
          description: A human readable title to the message response.
        results:
          type: array
          description: Results which matched the query. This is an array of objects.
          items:
            type: object
      required:
        - type
      example:
        type: 'urn:dx:dmp:Success'
        title: Success
        results:
          - productID: 'urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb'
    exampleResponseListPurchases:
      type: object
      title: Root type for purchases API response
      description: example response for list products
      properties:
        type:
          type: string
          description: URN type of the response indicating if the query was successful or if any errors have been triggered.
        title:
          description: A human readable title to the message response.
        totalHits:
          type: integer
          description: Total number of documents which matched the query.
          format: int32
        results:
          type: array
          description: Results which matched the query. This is an array of objects.
          items:
            type: object
      example:
        type: 'urn:dx:dmp:Success'
        title: Success
        totalHits: 1
        results:
          - productID: 'urn:datakaveri.org:iisc.ac.in/123qwerty:zxcvb'
            consumerID: 89a36273d77dac4cf38114fca1bbe64392547f86
            paymentStatus: payment.succeeded
            paymentTime: '2022-11-23T09:00:00Z'
            expiry: '2023-11-22T09:00:00Z'
            status: active/expired
    exampleVerifyRequestBody:
      type: object
      title: Root type for verify API body
      description: 'example request for verifying if consumer has purchased product, and if the purchase is expired or not'
      properties:
        user:
          $ref: '#/components/schemas/user'
        owner:
          $ref: '#/components/schemas/owner'
        item:
          $ref: '#/components/schemas/item'
    user:
      type: object
      title: schemaUser
      description: consumer information
      properties:
        id:
          type: string
          format: uuid
          pattern: '^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$'
          minLength: 36
          maxLength: 36
        name:
          $ref: '#/components/schemas/name'
        email:
          type: string
          pattern: '^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$'
          minLength: 1
      required:
        - id
        - name
        - email
    name:
      type: object
      title: schemaName
      properties:
        firstName:
          type: string
        lastName:
          type: string
    owner:
      type: object
      title: schemaOwner
      description: provider information
      properties:
        id:
          type: string
          format: uuid
          pattern: '^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$'
          minLength: 36
          maxLength: 36
        name:
          $ref: '#/components/schemas/name'
        email:
          type: string
          pattern: '^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$'
          minLength: 1
      required:
        - id
        - name
        - email
    item:
      type: object
      description: resource information
      properties:
        itemId:
          type: string
          format: uuid
          pattern: '^[0-9a-f]{8}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{4}\b-[0-9a-f]{12}$'
          minLength: 36
          maxLength: 36
        itemType:
          type: string
          enum:
            - resource
          minLength: 1
      required:
        - itemId
        - itemType
    verifyPolicySuccessResponse:
      type: object
      title: Verify policy success response
      properties:
        type:
          type: string
          description: URN type of success response
        apdConstraints:
          type: object
          description: Constraints of the policy
      required:
        - type
        - apdConstraints
      example:
        type: 'urn:apd:allow'
        apdConstraints:
          rule: read
          duration: 3600
    verifyPolicyBadRequestResponse:
      type: object
      title: 400 Response for verify policy
      properties:
        type:
          type: string
          description: URN type of error response
        title:
          type: string
          description: title of the error response
        detail:
          type: string
          description: Error message describing the issue
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:dx:dm:invalidPayloadFormat'
        title: Bad Request
        detail: 'Invalid json format in post request [schema mismatch]'
    verifyPolicyForbiddenResponse:
      type: object
      title: 403 Response for verify policy
      properties:
        type:
          type: string
          description: URN type of the error response
        title:
          type: string
          description: title of the error message
        detail:
          type: string
          description: Description of error message
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:apd:Deny'
        title: Forbidden
        detail: No policy exists for the given resource
    getPolicySuccessResponseWithResourceType:
      type: object
      title: get policy for resource item type.
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        results:
          type: array
          items:
            type: object
            properties:
              policyId:
                type: string
              itemId:
                type: string
              accessPolicy:
                type: string
              resourceName:
                type: string
              productVariantId:
                type: string
              resourceServerUrl:
                type: string
              consumer:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: array
                      items:
                        type: object
                        properties:
                          email:
                            type: string
                          name:
                            type: array
                            items:
                              type: object
                              properties:
                                firstName:
                                  type: string
                                lastName:
                                  type: string
                          id:
                            type: string
              provider:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: array
                      items:
                        type: object
                        properties:
                          email:
                            type: string
                          name:
                            type: array
                            items:
                              type: object
                              properties:
                                firstName:
                                  type: string
                                lastName:
                                  type: string
                          id:
                            type: string
              status:
                type: string
                enum:
                  - ACTIVE
                  - DELETED
              expiryAt:
                type: string
              constraints:
                type: object
      required:
        - type
        - title
        - results
      example:
        type: 'urn:dx:dmp:success'
        title: Success
        results:
          - policyId: c0ad9c9e-cdb3-4f08-bb35-7843ee8f8092
            resourceId: e81fdfb3-695e-4f1e-8458-ecdb2ca813e5
            resourceServerUrl: rs.iudx.io
            purchaseId: 6eb2428f-6b6f-4b84-a4ef-08d16c312283
            resourceName: surat-itms
            productVariantId: c5c32d00-8edf-418e-9f60-953b76887814
            accessPolicy: SECURE
            status: ACTIVE
            expiryAt: '2025-04-04T04:05:06'
            constraints:
              access: file
            consumer:
              email: vasanth.rajaraman@datakaveri.org
              name:
                firstName: Vasanth
                lastName: Rajaraman
              id: fd47486b-3497-4248-ac1e-082e4d37a66c
            provider:
              email: provider@gmail.com
              name:
                firstName: Bob
                lastName: Provider
              id: 47a77164-15c8-4311-be69-b4c27be570dd
    Unauthorized:
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:dx:dmp:invalidAuthorizationToken'
        title: Not Authorized
        detail: Not Authorized
    policyNotFound:
      type: object
      title: policyNotFound
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:dx:dmp:resourceNotFound'
        title: Not Found
        detail: Policy Not Found
    deletePolicy:
      type: object
      title: deletePolicy
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:dx:dmp:success'
        title: Success
        detail: Policy deleted successfully
    deletePolicyErrorResponse:
      type: object
      title: deletePolicyErrorResponse
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:dx:dmp:badRequest'
        title: Bad Request
        detail: 'Policy could not be deleted, as policy is not ACTIVE'
    deletePolicyNotFoundErrorResponse:
      type: object
      title: deletePolicyNotFoundErrorResponse
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: 'urn:dx:dmp:resourceNotFound'
        title: Not Found
        detail: 'Policy could not be deleted, as it doesn''t exist'
    createPolicy:
      title: createPolicy
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:success
        title: Success
        detail: Policy created successfully

    createPolicyErrorResponse:
      title: createPolicyErrorResponse
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:badRequest
        title: Bad Request
        detail: Invalid json format in post request [schema mismatch]

    createLinkedAccount:
      title: createLinkedAccount
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:success
        title: Success
        detail: Linked account created successfully with accountId - acc_NSQXtot69r4Sw3

    createLinkedAccountErrorResponse:
      title: createLinkedAccountErrorResponse
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:badRequest
        title: Bad Request
        detail: Linked account could not be as, the legal business name field is required.

    updateLinkedAccount:
      title: updateLinkedAccount
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:success
        title: Success
        detail: Linked account updated successfully

    updateLinkedAccountErrorResponse:
      title: updateLinkedAccountErrorResponse
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:success
        title: Bad Request
        detail: Linked account could not be updated as, the pan field is invalid

    updateLinkedAccountNotFoundResponse:
      title: updateLinkedAccountNotFoundResponse
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:success
        title: Bad Request
        detail: Linked account could not be updated as, the id provided does not exist


    fetchLinkedAccountWithGivenFields:
      title: Linked account with DMP APD stated fields
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        results:
          type: object
          properties:
            id:
              type: string
              minLength: 18
              maxLength: 18
            type:
              type: string
              enum: [ route ]
            status:
              type: string
              enum: [ created ]
            email:
              type: string
              pattern: '^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$'
            profile:
              type: object
              properties:
                category:
                  type: string
                  minLength: 1
                subcategory:
                  type: string
                  minLength: 1
                addresses:
                  type: object
                  properties:
                    street1:
                      type: string
                      minLength: 1
                      maxLength: 100
                    street2:
                      type: string
                      minLength: 1
                      maxLength: 100
                    city:
                      type: string
                      minLength: 1
                      maxLength: 100
                    state:
                      type: string
                      minLength: 2
                      maxLength: 32
                    postalCode:
                      type: string
                      minLength: 6
                      maxLength: 6
                    country:
                      type: string
                      minLength: 2
                      maxLength: 64
                  required:
                    - street1
                    - street2
                    - city
                    - state
                    - postalCode
                    - country
              required:
                - category
                - subcategory
                - addresses
            notes:
              type: array
              items:
                type: string
            phone:
              type: string
              minLength: 8
              maxLength: 15
            contactName:
              type: string
              minLength: 4
              maxLength: 255
            referenceId:
              type: string
              minLength: 20
              maxLength: 20
            businessType:
              type: string
            legalBusinessName:
              type: string
              minLength: 4
              maxLength: 200
            customerFacingBusinessName:
              type: string
              minLength: 1
              maxLength: 255
            legalInfo:
              type: object
              properties:
                pan:
                  type: string
                  minLength: 10
                  maxLength: 10
                  pattern: '/^[a-zA-z]{5}\d{4}[a-zA-Z]{1}$/'
                gst:
                  type: string
                  minLength: 15
                  maxLength: 15
                  pattern: '/^[0123][0-9][a-z]{5}[0-9]{4}[a-z][0-9][a-z0-9][a-z0-9]$/gi'
              required:
                - pan
                - gst
          required:
            - id
            - type
            - status
            - email
            - profile
            - notes
            - phone
            - contactName
            - referenceId
            - businessType
            - legalBusinessName
            - customerFacingBusinessName
            - legalInfo
      required:
        - type
        - title
        - results
      example:
        type: urn:dx:dmp:success
        title: Success
        results:
          {
            "id": "acc_GRWKk7qQsLnDjX",
            "type": "route",
            "status": "created",
            "email": "test.provider@gmail.com",
            "profile": {
              "category": "healthcare",
              "subcategory": "doctors",
              "addresses": {
                "registered": {
                  "street1": "Outer Ring road",
                  "street2": "MG Road",
                  "city": "Bengaluru",
                  "state": "KARNATAKA",
                  "postalCode": "560038",
                  "country": "india"
                }
              }
            },
            "notes": [ ],
            "phone": "9100090000",
            "contactName": "Test Name",
            "referenceId": "9db3e89b9db3e89b85e1",
            "businessType": "partnership",
            "legalBusinessName": "Dummy Corp V1",
            "customerFacingBusinessName": "Dummy Corp V1",
            "legalInfo": {
              "pan": "ABACL1234C",
              "gst": "19AABCU9603R1ZM"
            }
          }



    fetchLinkedAccountWithOtherFields:
      title: Linked Account with other fields
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        results:
          type: object
          properties:
            id:
              type: string
              minLength: 18
              maxLength: 18
            type:
              type: string
              enum: [ route ]
            status:
              type: string
              enum: [ created ]
            email:
              type: string
              pattern: '^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$'
            profile:
              type: object
              properties:
                category:
                  type: string
                  minLength: 1
                subcategory:
                  type: string
                  minLength: 1
                addresses:
                  type: object
                  properties:
                    street1:
                      type: string
                      minLength: 1
                      maxLength: 100
                    street2:
                      type: string
                      minLength: 1
                      maxLength: 100
                    city:
                      type: string
                      minLength: 1
                      maxLength: 100
                    state:
                      type: string
                      minLength: 2
                      maxLength: 32
                    postalCode:
                      type: string
                      minLength: 6
                      maxLength: 6
                    country:
                      type: string
                      minLength: 2
                      maxLength: 64
                  required:
                    - street1
                    - street2
                    - city
                    - state
                    - postalCode
                    - country
                operation:
                  type: object
                  properties:
                    street1:
                      type: string
                      minLength: 1
                      maxLength: 100
                    street2:
                      type: string
                      minLength: 1
                      maxLength: 100
                    city:
                      type: string
                      minLength: 1
                      maxLength: 100
                    state:
                      type: string
                      minLength: 2
                      maxLength: 32
                    country:
                      type: string
                      minLength: 2
                      maxLength: 64
                businessModel:
                  type: string
                  nullable: true
              required:
                - category
                - subcategory
                - addresses
            notes:
              type: array
              items:
                type: string
            phone:
              type: string
              minLength: 8
              maxLength: 15
            contactName:
              type: string
              minLength: 4
              maxLength: 255
            referenceId:
              type: string
              minLength: 20
              maxLength: 20
            businessType:
              type: string
            legalBusinessName:
              type: string
              minLength: 4
              maxLength: 200
            customerFacingBusinessName:
              type: string
              minLength: 1
              maxLength: 255
            legalInfo:
              type: object
              properties:
                pan:
                  type: string
                  minLength: 10
                  maxLength: 10
                  pattern: '/^[a-zA-z]{5}\d{4}[a-zA-Z]{1}$/'
                gst:
                  type: string
                  minLength: 15
                  maxLength: 15
                  pattern: '/^[0123][0-9][a-z]{5}[0-9]{4}[a-z][0-9][a-z0-9][a-z0-9]$/gi'
              required:
                - pan
                - gst
            apps:
              type: object
              properties:
                websites:
                  type: array
                  items:
                    type: string
                android:
                  type: array
                  items:
                    type: object
                    properties:
                      url:
                        type: string
                        nullable: true
                      name:
                        type: string
                        nullable: true
                ios:
                  type: array
                  items:
                    type: object
                    properties:
                      url:
                        type: string
                        nullable: true
                      name:
                        type: string
                        nullable: true
            brand:
              type: object
              properties:
                color:
                  type: string
                  nullable: true
            contactInfo:
              type: object
              properties:
                chargeback:
                  type: object
                  properties:
                    email:
                      type: string
                      nullable: true
                    phone:
                      type: string
                      nullable: true
                    policyUrl:
                      type: string
                      nullable: true

                refund:
                  type: object
                  properties:
                    email:
                      type: string
                      nullable: true
                    phone:
                      type: string
                      nullable: true
                    policyUrl:
                      type: string
                      nullable: true
                support:
                  type: object
                  properties:
                    email:
                      type: string
                      nullable: true
                    phone:
                      type: string
                      nullable: true
                    policyUrl:
                      type: string
                      nullable: true
          required:
            - id
            - type
            - status
            - email
            - profile
            - notes
            - phone
            - contactName
            - referenceId
            - businessType
            - legalBusinessName
            - customerFacingBusinessName
            - legalInfo
      required:
        - type
        - title
        - results
      example:
        type: urn:dx:dmp:success
        title: Success
        results:
          {
            "id": "acc_NBK8KJeLl7fvpC",
            "type": "route",
            "status": "created",
            "email": "test.provider@gmail.com",
            "profile": {
              "category": "healthcare",
              "subcategory": "doctors",
              "addresses": {
                "registered": {
                  "street1": "Outer Ring road",
                  "street2": "MG Road",
                  "city": "Bengaluru",
                  "state": "KARNATAKA",
                  "postalCode": 560038,
                  "country": "india"
                },
                "operation": {
                  "street1": "507, Koramangala 6th block",
                  "street2": "Kormanagala",
                  "city": "Bengaluru",
                  "state": "KARNATAKA",
                  "country": "IN",
                }
              },
              "businessModel": null
            },
            "notes": [

            ],
            "phone": "9100090000",
            "contactName": "Test Name",
            "referenceId": "12345678912345678912",
            "businessType": "partnership",
            "legalBusinessName": "Dummy Corp V2",
            "customerFacingBusinessName": "Some Other Corp",
            "legalInfo": {
              "pan": "ABACL1234C",
              "gst": "19AABCU9603R1ZM"
            },
            "apps": {
              "websites": [

              ],
              "android": [
                {
                  "url": null,
                  "name": null
                }
              ],
              "ios": [
                {
                  "url": null,
                  "name": null
                }
              ]
            },
            "brand": {
              "color": null
            },
            "contactInfo": {
              "chargeback": {
                "email": null,
                "phone": null,
                "policyUrl": null
              },
              "refund": {
                "email": null,
                "phone": null,
                "policyUrl": null
              },
              "support": {
                "email": null,
                "phone": null,
                "policyUrl": null
              }
            }
          }

    fetchLinkedAccountNotFound:
      title: fetchLinkedAccountNotFound
      type: object
      properties:
        type:
          type: string
          minLength: 1
        title:
          type: string
          minLength: 1
        detail:
          type: string
          minLength: 1
      required:
        - type
        - title
        - detail
      example:
        type: urn:dx:dmp:resourceNotFound
        title: Not Found
        detail: Linked account cannot be fetched as, it is not found




